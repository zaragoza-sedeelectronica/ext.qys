<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="es" xmlns:sede="http://www.zaragoza.es"
      xmlns:th="http://www.thymeleaf.org">
    <head>
        <meta charset="utf-8"/>
        <sede:meta title="Contratación Pública"
                   keywords="sede,web,pública,contratos,ayuntamiento,zaragoza,contratación"/>
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-slider/9.5.1/css/bootstrap-slider.min.css"/>

    </head>
    <body>
        <sede:content>
            <th:block th:include="fragmentos/error" />
            <div th:if="${resultado.statusCode.value()} == 200" th:object="${resultado.body}"
                 vocab="http://schema.org/">
                <div class="second-bar clearfix">
                    <div class="hidden-xs form-group">
                        <div class="col-md-6">
                            <form method="get">
                                <div class="input-group">
                                <input type="text" id="title" name="titleContains"
                                       placeholder="Funcionalidad de Búsqueda por titulo/objeto" class="form-control"/>
                                    <span class="input-group-btn">
                                        <button type="submit" class="btn btn-search"><span class="glyphicon glyphicon-search"></span></button>
                                    </span>
                                </div>
                            </form>
                        </div>
                        <div class="col-md-6">
                            <label for="entityEnlace" class="control-label col-md-3">Entidad:</label>
                            <div class="col-md-9">
                                <select id="entityEnlace" name="entity.id" class="form-control">
                                    <option value="">- Selecciona Entidad -</option>
                                    <option value="11">Artes Escénicas y de la Imagen</option>
                                    <option value="5">Audiorama Zaragoza</option>
                                    <option value="1">Ayuntamiento de Zaragoza</option>
                                    <option value="14">Ecociudad</option>
                                    <option value="4">Educación y Bibliotecas</option>
                                    <option value="2">Zaragoza Cultural</option>
                                    <option value="8">Zaragoza Deporte</option>
                                    <option value="7">Zaragoza Dinámica</option>
                                    <option value="12">Zaragoza Pirineos</option>
                                    <option value="6">Zaragoza Turismo</option>
                                    <option value="3">Zaragoza Vivienda</option>
                                    <option value="10">ZGZ @ Desarrollo Expo, S.A., en liquidación</option>
                                </select>
                            </div>
                        </div>
                        <div class="col-md-12" style="margin-top:15px;">
                        <ul class="pull-right list-inline navbar-right submenu">
                            <li>
                                <a href="/sede/servicio/contratacion-publica/?status.id=0">En licitación</a>
                            </li>
                            <li>
                                <a href="/sede/servicio/contratacion-publica/?type.id=1">Obras</a>
                            </li>
                            <li>
                                <a href="/sede/servicio/contratacion-publica/?type.id=2">Servicios</a>
                            </li>
                            <li>
                                <a href="/sede/servicio/contratacion-publica/?type.id=3">Suministros</a>
                            </li>
                            <li>
                                <a data-toggle="collapse" href="#buscadorContratos" aria-expanded="false"
                                   aria-controls="buscadorContratos">Búsqueda Avanzada</a>
                            </li>
                        </ul>
                        </div>
                    </div>
                </div>
                <form id="BuscadorAvanzado" method="get">
                    <div id="buscadorContratos" class="panel-collapse collapse">
                        <div class="panel panel-default">
                            <div class="panel-heading" id="buscadorContratos-title">
                                <h3 class="panel-title">
                                    <a role="button" data-toggle="collapse" href="#buscadorContratos"
                                       aria-expanded="false" aria-controls="buscadorContratos" class="btn-block">
                                        <span class="fa fa-search"></span>
                                        Búsqueda Avanzada
                                    </a>
                                </h3>
                            </div>
                            <div>
                                <div class="clearfix padding-a1em">
                                    <div class="form-group col-md-4">
                                        <label for="title" class="control-label col-md-3">Título:</label>
                                        <div class="col-md-9">
                                            <input id="title" name="titleContains" type="text"
                                                   class="form-control"></input>
                                            <input id="objeto" name="objetoContains" type="hidden"
                                                   class="form-control"></input>
                                        </div>
                                    </div>

                                    <div class="form-group col-md-4">
                                        <label for="expediente" class="control-label col-md-3">Expediente:</label>
                                        <div class="col-md-9">
                                            <input id="expediente" name="expedienteContains" type="text"
                                                   class="form-control"></input>
                                        </div>
                                    </div>
                                    <div class="form-group col-md-4">
                                        <label for="year" class="control-label col-md-3">Fechas:</label>
                                        <div class="col-md-9">
                                            Desde:
                                            <input class="form-control datepicker" type="text" name="fechaContratoFrom" data-date-format="dd-mm-yyyy" data-date-language="es" data-provide="datepicker"/>
                                            Hasta:
                                            <input class="form-control datepicker" type="text" name="fechaContratoTill" data-date-format="dd-mm-yyyy" data-date-language="es" data-provide="datepicker"/>
                                        </div>
                                    </div>
                                    <div class="form-group col-md-4">
                                        <label for="entity" class="control-label col-md-3">Entidad:</label>
                                        <div class="col-md-9">
                                            <select id="entity" name="entity.id" class="form-control">
                                                <option value="">- Selecciona Entidad -</option>
                                                <option value="11">Artes Escénicas y de la Imagen</option>
                                                <option value="5">Audiorama Zaragoza</option>
                                                <option value="1">Ayuntamiento de Zaragoza</option>
                                                <option value="14">Ecociudad</option>
                                                <option value="4">Educación y Bibliotecas</option>
                                                <option value="2">Zaragoza Cultural</option>
                                                <option value="8">Zaragoza Deporte</option>
                                                <option value="7">Zaragoza Dinámica</option>
                                                <option value="12">Zaragoza Pirineos</option>
                                                <option value="6">Zaragoza Turismo</option>
                                                <option value="3">Zaragoza Vivienda</option>
                                                <option value="10">ZGZ @ Desarrollo Expo, S.A., en liquidación</option>
                                            </select>
                                        </div>
                                    </div>
                                    <div class="form-group col-md-4" id="OrganismoDiv">
                                        <label for="organoContratante" class="control-label col-md-5">Órgano Contratación:</label>
                                        <div class="col-md-7">
                                            <select id="organoContratante" name="organoContratante" class="form-control" >
                                                <option value="" selected="selected">- Selecciona Organo - </option>
                                                <option value="61578">Consejería de Economía y Cultura del Ayuntamiento de Zaragoza</option>
                                                <option value="61583">Concejalía Delegada de Educación e Inclusión del Ayuntamiento de Zaragoza</option>
                                                <option value="10522">Gobierno de Zaragoza</option>
                                                <option value="61585">Concejalía Delegada de Medio Ambiente y Movilidad del Ayuntamiento de Zaragoza</option>
                                                <option value="61676">Consejería de Participación, Transparencia y Gobierno Abierto del Ayuntamiento de Zaragoza</option>
                                                <option value="61673">Consejería de Presidencia y Derechos Sociales del Ayuntamiento de Zaragoza</option>
                                                <option value="61581">Consejería de Servicios Públicos y Personal del Ayuntamiento de Zaragoza</option>
                                                <option value="61580">Consejería de Urbanismo y Sostenibilidad del Ayuntamiento de Zaragoza</option>
                                                <option value="61584">Concejalía Delagada de Vivienda y Deporte del Ayuntamiento de Zaragoza</option>
                                                <option value="25030">Presidencia del Organismo Autónomo Zaragoza Turismo</option>
                                                <option value="10328">Concejalía Delegada de la Policía Local del Ayuntamiento de Zaragoza</option>
                                                <option value="61237">Presidencia del Instituto Municipal de Empleo y Fomento Empresarial de Zaragoza</option>
                                            </select>
                                        </div>
                                    </div>
                                    <div class="form-group col-md-4" id="servicioDiv" style="display:none;">
                                        <label for="servicio" class="control-label col-md-3">Servicio:</label>
                                        <div class="col-md-9">
                                            <input type="text" id="servicio" value="" autocomplete="off"
                                                   placeholder="Buscar servicio" class="form-control"
                                                   title="Buscar servicio" disabled="disabled"/>
                                            <input type="hidden" id="servicioGestor" name="servicio"/>
                                        </div>
                                    </div>
                                    <div class="clearfix"></div>
                                    <div class="form-group col-md-4">
                                        <label for="ofertas.adjudicatarioContains" class="control-label col-md-3">
                                            Licitador:
                                        </label>
                                        <div class="col-md-9">
                                            <input id="ofertas.adjudicatarioContains"
                                                   name="ofertas.adjudicatarioContains" type="text"
                                                   class="form-control"></input>
                                        </div>
                                    </div>
                                    <div class="form-group col-md-4">
                                        <label for="status.id" class="control-label col-md-3">Estado:</label>
                                        <div class="col-md-9">
                                            <select id="status.id" name="status.id" class="form-control">
                                                <option value="" selected="selected">- Selecciona estado del contrato
                                                    -
                                                </option>
                                                <option value="0">En Licitación</option>
                                                <option value="1">Pendiente de Adjudicar</option>
                                                <option value="2">Adjudicación Provisional</option>
                                                <option value="3">Adjudicación Definitiva</option>
                                                <option value="5">Adjudicación</option>
                                                <option value="6">Contrato Formalizado</option>
                                                <option value="4">Suspendida la licitación</option>
                                                <option value="7">Desierto</option>
                                                <option value="8">Renuncia</option>
                                                <option value="10">Cancelado</option>
                                                <option value="11">Desistido</option>
                                                <option value="9">Modificación de Contrato</option>
                                                <option value="12">Resuelto</option>
                                            </select>
                                        </div>
                                    </div>
                                    <div class="form-group col-md-4">
                                        <label for="type" class="control-label col-md-3">Tipo:</label>
                                        <div class="col-md-9">
                                            <select id="type" name="type.id" class="form-control">
                                                <option value="" selected="selected">- Selecciona tipo de contrato -
                                                </option>
                                                <option value="1">Obras</option>
                                                <option value="2">Servicios</option>
                                                <option value="3">Suministros</option>
                                                <option value="4">Otros</option>
                                                <option value="5">Privado</option>
                                            </select>
                                        </div>
                                    </div>
                                    <div class="form-group col-md-4">
                                        <label for="procedimiento" class="control-label col-md-4">Procedimiento:</label>
                                        <div class="col-md-8">
                                            <select id="procedimiento" name="procedimiento.id" class="form-control">
                                                <option value="" selected="selected">- Selecciona -</option>
                                                <option value="1">Abierto</option>
                                                <option value="8">Abierto Simplificado</option>
                                                <option value="5">Abierto y conjuntamente primer contrato derivado</option>
                                                <option value="13">Abierto, reservada a Empresas de Inserción</option>
                                                <option value="11">Basado en Acuerdo Marco</option>
                                                <option value="4">Directo</option>
                                                <option value="6">Enajenación directa</option>
                                                <option value="10">Menor</option>
                                                <option value="7">Negociado sin publicidad</option>
                                                <option value="3">Negociado sin publicidad ni concurrencia</option>
                                                <option value="14">Otros</option>
                                                <option value="2">Restringido</option>
                                                <option value="12">Sin requisitos de solvencia profesional o económica, con presentación de memoria comercial y ofertas económicas</option>
                                                <option value="9">Venta directa</option>
                                            </select>
                                        </div>
                                    </div>
                                    <div class="form-group col-md-4">
                                        <label for="cpv" class="control-label col-md-3">CPV:</label>
                                        <div class="col-md-9">
                                            <input type="text" id="cpvSelect" value="" autocomplete="off"
                                                   placeholder="Buscar CPV" class="form-control" title="Buscar CPV"/>
                                            <input type="hidden" id="cpv" name="cpv.id"/>
                                        </div>
                                    </div>
                                    <div class="col-xs-12 col-md-4" style="text-align: center;">
                                        <input type="submit" id="enviar" value="Consultar"
                                               class="btn btn-primary"></input>
                                    </div>
                                    <div class="clearfix"></div>
                                    <div class="form-group col-md-6">
                                        <div class="form-group col-md-4">
                                            <label for="rangoImporte">Importe:</label>
                                            <div class="col-sm-9 col-md-10">
                                                <input type="radio" name="rangoImporte" value="true" aria-label="si"/>
                                                Sin IVA
                                                <br/>
                                                <input type="radio" name="rangoImporte" value="false" aria-label="no"/>
                                                Con IVA
                                            </div>
                                        </div>
                                        <div class="form-group col-md-9" disabled="disabled">
                                            <p class="margin-t1em">Seleccionar rango:</p>
                                            <p>
                                                <span class="margin-r05em">100€</span>
                                                <input id="rangoImporte" type="text" value=""
                                                       data-slider-id="rangoImporte" data-slider-min="100"
                                                       data-slider-min-value="200" data-slider-max="60000000"
                                                       data-slider-step="4" data-slider-value="[100,60000000]"
                                                       data-slider-ticks-labels="['100€', '60000000€']"
                                                       class="rangoImporte"/>
                                                <span class="margin-l05em">60.000.000 €</span>
                                            </p>
                                            <input type="hidden" id="importeFrom" name="importeConIVAFrom"/>
                                            <input type="hidden" id="importeTill" name="importeConIVATill"/>
                                        </div>
                                    </div>

                                </div>
                            </div>
                        </div>
                    </div>
                </form>
                <div class="alert alert-info col-md-12" th:if="${#lists.isEmpty(resultado.body.result)}">
                    <div class="solr-search-criteria">
                        <strong>Criterios aplicados:</strong>
                        <ul th:each="p :${parametros_busqueda}" class="list-inline nopadding margin-a05em">
                            <li th:text="${p}" class="label label-success">En licitación</li>
                        </ul>
                    </div>
                    No existen contratos
                </div>
                <div class="second-bar" th:if="${not #lists.isEmpty(resultado.body.result)}">
                    <div class="col-md-4 clearfix">
                        <div class="solr-search-criteria">
                            <strong>Criterios aplicados:</strong>
                            <ul th:each="p :${parametros_busqueda}" class="list-inline nopadding margin-a05em">
                                <li th:text="${p}" class="label label-success">En licitación</li>
                            </ul>
                        </div>
                    </div>
                    <div class="col-md-5 clearfix">
                        <div class="solr-search-criteria">
                            <strong>Ordenar por :</strong>
                            <ul class="list-inline nopadding margin-a05em">
                                <li th:class="${#httpServletRequest.getQueryString()!=null? #strings.indexOf(#httpServletRequest.getQueryString(),'sort=fechaPresentacion')>=0?'label label-success':'label label-info':'label label-info'}">
                                    <a th:href="'/sede/servicio/contratacion-publica/?' + ${#httpServletRequest.getQueryString()!=null ?
                                    #strings.contains(#httpServletRequest.getQueryString(),'sort') == true ?
                                    #strings.substring(#httpServletRequest.getQueryString(),0,#strings.indexOf(#httpServletRequest.getQueryString(),'sort'))+'sort=fechaPresentacion asc': 'sort=fechaPresentacion asc':'sort=fechaPresentacion asc'}"
                                       th:class="${#httpServletRequest.getQueryString()!=null? #strings.indexOf(#httpServletRequest.getQueryString(),'sort=fechaPresentacion')>=0?'success':'info':'info'}">
                                        Presentación
                                    </a>
                                </li>

                                <li th:class="${#httpServletRequest.getQueryString()!=null? #strings.indexOf(#httpServletRequest.getQueryString(),'sort=entity.title')>=0?'label label-success':'label label-info':'label label-info'}">
                                  <a th:href="'/sede/servicio/contratacion-publica/?' + ${#httpServletRequest.getQueryString()!=null ? #strings.contains(#httpServletRequest.getQueryString(),'sort') == true ? #strings.contains(#httpServletRequest.getQueryString(),'sort=entity.title%20desc') == true ? #strings.substring(#httpServletRequest.getQueryString(),0,#strings.indexOf(#httpServletRequest.getQueryString(),'sort=entity.title%20desc'))+'sort=entity.title asc':#strings.contains(#httpServletRequest.getQueryString(),'sort=entity.title%20asc') == true ? #strings.substring(#httpServletRequest.getQueryString(),0,#strings.indexOf(#httpServletRequest.getQueryString(),'sort=entity.title%20asc'))+'sort=entity.title desc':#httpServletRequest.getQueryString()+'&amp;sort=entity.title desc':#httpServletRequest.getQueryString()+'&amp;sort=entity.title desc':'sort=entity.title desc'}"
                                       th:class="${#httpServletRequest.getQueryString()!=null ?
                                       #strings.indexOf(#httpServletRequest.getQueryString(),'sort=entity.title')>=0?'success':'info':'info'}"
                                       >
                                        Entidad
                                    </a>
                                </li>
                                <li th:class="${#httpServletRequest.getQueryString()!=null? #strings.indexOf(#httpServletRequest.getQueryString(),'sort=contratoMenor')>=0?'label label-success':'label label-info':'label label-info'}">
                                    <a th:href="'/sede/servicio/contratacion-publica/?' + ${#httpServletRequest.getQueryString()!=null ? #strings.contains(#httpServletRequest.getQueryString(),'sort') == true ? #strings.contains(#httpServletRequest.getQueryString(),'sort=contratoMenor%20desc') == true ? #strings.substring(#httpServletRequest.getQueryString(),0,#strings.indexOf(#httpServletRequest.getQueryString(),'sort=contratoMenor%20desc'))+'sort=contratoMenor asc':#strings.contains(#httpServletRequest.getQueryString(),'sort=contratoMenor%20asc') == true ? #strings.substring(#httpServletRequest.getQueryString(),0,#strings.indexOf(#httpServletRequest.getQueryString(),'sort=contratoMenor%20asc'))+'sort=contratoMenor desc':#httpServletRequest.getQueryString()+'&amp;sort=contratoMenor desc':#httpServletRequest.getQueryString()+'&amp;sort=contratoMenor desc':'sort=contratoMenor desc'}"
                                       th:class="${#httpServletRequest.getQueryString()!=null  ?
                                       #strings.indexOf(#httpServletRequest.getQueryString(),'sort=contratoMenor')>=0?'success':'info':'info'}">
                                        Mayor/Menor
                                    </a>
                                </li>
                            </ul>
                        </div>
                    </div>
                    <div class="col-md-3 clearfix">
                        <p class="nomargin destacado text-right">
                            Descargar:
                            <a href="https://www.zaragoza.es/sede/servicio/catalogo/2120">Datos Abiertos</a>
                        </p>
                        <ul class="list-inline pull-right">
                            <li class="nopadding">
                                <a th:href="'/sede/servicio/contratacion-publica.json?' + ${#httpServletRequest.getQueryString() != null ? #httpServletRequest.getQueryString()  :  ''}">
                                    JSON
                                </a>                                |
                            </li>
                            <li class="nopadding">
                                <a th:href="'/sede/servicio/contratacion-publica.xml?' + ${#httpServletRequest.getQueryString() != null ? #httpServletRequest.getQueryString()  :  ''}">
                                    XML
                                </a>
                                |
                            </li>
                            <li class="nopadding">
                                <a th:href="'/sede/servicio/contratacion-publica.csv?' + ${#httpServletRequest.getQueryString() != null ? #httpServletRequest.getQueryString()  :  ''}">
                                    CSV
                                </a>
                            </li>
                        </ul>
                    </div>
                    <ul class="row list-unstyled resultado">
                        <li class="col-xs-12 col-sm-12 col-md-6" th:each="doc: ${resultado.body.result}">
                           <th:block th:if="${doc.status.id==3 or doc.status.id==6 or doc.status.id==5 }"
                                      th:include="servicio/contratacion-publica/detalle-listado-adjudicado"/>
                            <th:block th:unless="${doc.status.id==3 or doc.status.id==6 or doc.status.id==5 }"
                                      th:include="servicio/contratacion-publica/detalle-listado-noadjudicado"/>
                        </li>
                    </ul>
                </div>
            </div>
            <th:block th:utext="${resultado.body.getPaginacion(#httpServletRequest)}" />
        </sede:content>
        <script type="text/javascript" src="https://cdn.datatables.net/1.10.15/js/jquery.dataTables.min.js"></script>
        <script type="text/javascript" src="//www.zaragoza.es/cont/plantillas/sede/js/typeahead.bundle.js"></script>
        <script type="text/javascript"
                src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.6.4/js/bootstrap-datepicker.min.js"></script>
        <script src="https://www.zaragoza.es/cont/assets/less/bootstrap-slider-master/dist/bootstrap-slider.min.js"></script>
        <script src="https://www.zaragoza.es/cont/assets/lib/bootstrap-3.3.7/js/bootstrap.min.js"></script>
        <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.6.4/js/bootstrap-datepicker.min.js"></script>
        <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.22.2/moment.min.js"></script>
        <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.22.2/locale/es.js"></script>
        <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datetimepicker/4.17.47/js/bootstrap-datetimepicker.min.js"></script>
        <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.6.4/locales/bootstrap-datepicker.es.min.js"></script>
        <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.2/js/select2.min.js"></script>
        <script type="text/javascript">
            /*<![CDATA[*/
            $('.datetimepicker').datetimepicker({
            format:'dd-mm-yyyy'
        });
        //Cuando se inserta en Título también busca en Objeto
        $('#title').change(function () {
           // console.log("entra");
            //console.log($('#title').val());
            //$('#objeto').val($('#title').val());
        });

        //Se activa el input Servicio cuando se selecciona la Entidad Ayto Zgz
        $("select#entity").change(function () {
            if ($('#entity').val() == 1) {
                $('#servicioDiv').toggle();    
                $('#servicio').removeAttr('disabled');
            } else {
                $('#servicio').attr('disabled','disabled');
                if($('#servicioDiv').css('display')=='block')$('#servicioDiv').toggle(); 
            }
        });

        //Rango Importe (con/sin IVA)
        $("#rangoImporte").slider({});
        $('div#rangoImporte').addClass('slider-disabled');
        $('.rangoImporte').attr('data-slider-enabled','false');
        $('input:radio').change(function () {
            $('#rangoImporte').removeClass('slider-disabled');
            console.log($(this));
            if ($(this).val() == 'false') { //con IVA

                $('#rangoImporte').attr('data-slider-enabled','true');
                  $('#importeFrom').attr('name','importeConIVAFrom');
                $('#importeTill').attr('name','importeConIVATill');
            } else if ($(this).val() == 'true') { //sin IVA
                $('#importeFrom').attr('name','importeSinIVAFrom');
                $('#importeTill').attr('name','importeSinIVATill');
            }
        });
        $('#entityEnlace').change(function (e) {
        e.preventDefault();
            var listValue = $(this).val();
           $(location).attr('href','/sede/servicio/contratacion-publica/?status.id=0&entity.id='+listValue);

        });

        //Cada vez que cambia el importe se actualizan los input hidden 
        $('#rangoImporte').change(function () {
            var listValue = $('.rangoImporte').val().split(',');
           
            $('#importeFrom').val(listValue[0]);
            $('#importeTill').val(listValue[1]);
        });
        

        //Buscador Servicio
        var servicioDataset = new Bloodhound({
            datumTokenizer: function(countries) {
                return Bloodhound.tokenizers.whitespace(result.value);
            },
            queryTokenizer: Bloodhound.tokenizers.whitespace,
            remote: {
                url: '/sede/servicio/contratacion-publica/servicio-gestor/?rows=10&q=title==%QUERY*&fl=id,title',
                
                filter: function(response) {
                //console.log(response);
                    return response.result;
                },
                wildcard: '%QUERY',
            }
        });
       
        $('#servicio').typeahead(null, {
            name: 'servicios',
            displayKey: function(results) {
                return results.title;
            },
            source: servicioDataset
        });
        $('#servicio').bind('typeahead:select', function(ev, suggestion) {
            //console.log('Selection: ' + JSON.stringify(suggestion));
            var item = suggestion;
            $('#servicioGestor').val(item.id);
            //table.draw();
        });
        //Buscador Cpv
        var cpvDataset = new Bloodhound({
            datumTokenizer: function(countries) {
                return Bloodhound.tokenizers.whitespace(result.value);
            },
            queryTokenizer: Bloodhound.tokenizers.whitespace,
            remote: {
                url: '/sede/servicio/contratacion-publica/cpv/?rows=10&q=titulo==%QUERY*&fl=id,titulo',

                filter: function(response) {
                //console.log(response);
                    return response.result;
                },
                wildcard: '%QUERY',
            }
        });
        //Buscador CPV
       /* var cpvDataset = new Bloodhound({
            datumTokenizer: Bloodhound.tokenizers.obj.whitespace('cpv'),
            queryTokenizer: Bloodhound.tokenizers.whitespace,
            prefetch: '/sede/servicio/contratacion-publica/cpv.json'
        });*/
        //console.log(cpvDataset);

        $('#cpvSelect').typeahead(null, {
            name: 'cpv',
            limit: 15,
            displayKey: 'titulo',
            source: cpvDataset
        });
        $('#cpvSelect').bind('typeahead:select', function(ev, suggestion) {
            //console.log('Selection: ' + JSON.stringify(suggestion));
            var item = suggestion;
            $('#cpv').val(item.id);
            //table.draw();
        });
        /*]]>*/
        </script>
    </body>
</html>
